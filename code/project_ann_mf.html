<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Untitled</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="project_ann_mf_files/libs/clipboard/clipboard.min.js"></script>
<script src="project_ann_mf_files/libs/quarto-html/quarto.js"></script>
<script src="project_ann_mf_files/libs/quarto-html/popper.min.js"></script>
<script src="project_ann_mf_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="project_ann_mf_files/libs/quarto-html/anchor.min.js"></script>
<link href="project_ann_mf_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="project_ann_mf_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="project_ann_mf_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="project_ann_mf_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="project_ann_mf_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Untitled</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, LabelEncoder</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPRegressor</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>csv_file_path <span class="op">=</span> <span class="st">'Placement_Data_Full_Class.csv'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(csv_file_path)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">#df['salary'] = df['salary'].fillna(0)</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   sl_no gender  ssc_p    ssc_b  hsc_p    hsc_b     hsc_s  degree_p  \
0      1      M  67.00   Others  91.00   Others  Commerce     58.00   
1      2      M  79.33  Central  78.33   Others   Science     77.48   
2      3      M  65.00  Central  68.00  Central      Arts     64.00   
3      4      M  56.00  Central  52.00  Central   Science     52.00   
4      5      M  85.80  Central  73.60  Central  Commerce     73.30   

    degree_t workex  etest_p specialisation  mba_p      status    salary  
0   Sci&amp;Tech     No     55.0         Mkt&amp;HR  58.80      Placed  270000.0  
1   Sci&amp;Tech    Yes     86.5        Mkt&amp;Fin  66.28      Placed  200000.0  
2  Comm&amp;Mgmt     No     75.0        Mkt&amp;Fin  57.80      Placed  250000.0  
3   Sci&amp;Tech     No     66.0         Mkt&amp;HR  59.43  Not Placed       NaN  
4  Comm&amp;Mgmt     No     96.8        Mkt&amp;Fin  55.50      Placed  425000.0  </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>(215, 15)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert categorical variables to numerical values</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>le <span class="op">=</span> LabelEncoder()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'gender'</span>] <span class="op">=</span> le.fit_transform(df[<span class="st">'gender'</span>])</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'ssc_b'</span>] <span class="op">=</span> le.fit_transform(df[<span class="st">'ssc_b'</span>])</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'hsc_b'</span>] <span class="op">=</span> le.fit_transform(df[<span class="st">'hsc_b'</span>])</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'hsc_s'</span>] <span class="op">=</span> le.fit_transform(df[<span class="st">'hsc_s'</span>])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'degree_t'</span>] <span class="op">=</span> le.fit_transform(df[<span class="st">'degree_t'</span>])</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'workex'</span>] <span class="op">=</span> le.fit_transform(df[<span class="st">'workex'</span>])</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'specialisation'</span>] <span class="op">=</span> le.fit_transform(df[<span class="st">'specialisation'</span>])</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'status'</span>] <span class="op">=</span> le.fit_transform(df[<span class="st">'status'</span>])</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(<span class="st">'salary'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'salary'</span>]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert target variable (salary) into categories</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> pd.cut(y, bins<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">100000</span>, <span class="dv">200000</span>, <span class="dv">300000</span>, <span class="dv">400000</span>, np.inf], labels<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.25</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> scaler.transform(X_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">10</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'identity'</span>,solver<span class="op">=</span><span class="st">'lbfgs'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>model2 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'identity'</span>,solver<span class="op">=</span><span class="st">'sgd'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>model3 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'identity'</span>,solver<span class="op">=</span><span class="st">'adam'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>model4 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'logistic'</span>,solver<span class="op">=</span><span class="st">'lbfgs'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>model5 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'logistic'</span>,solver<span class="op">=</span><span class="st">'sgd'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>model6 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'logistic'</span>,solver<span class="op">=</span><span class="st">'adam'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>model7 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'tanh'</span>,solver<span class="op">=</span><span class="st">'lbfgs'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>model8 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'tanh'</span>,solver<span class="op">=</span><span class="st">'sgd'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>model9 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'tanh'</span>,solver<span class="op">=</span><span class="st">'adam'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>model10 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'relu'</span>,solver<span class="op">=</span><span class="st">'lbfgs'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>model11 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'relu'</span>,solver<span class="op">=</span><span class="st">'sgd'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>model12 <span class="op">=</span> MLPRegressor(hidden_layer_sizes<span class="op">=</span>[<span class="dv">32</span>,<span class="dv">32</span>],activation<span class="op">=</span><span class="st">'relu'</span>,solver<span class="op">=</span><span class="st">'adam'</span>,tol<span class="op">=</span><span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">6</span>),max_iter<span class="op">=</span><span class="dv">1000</span>,n_iter_no_change<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>regr1 <span class="op">=</span> model1.fit(X_train, y_train)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>regr2 <span class="op">=</span> model2.fit(X_train, y_train)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>regr3 <span class="op">=</span> model3.fit(X_train, y_train)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>regr4 <span class="op">=</span> model4.fit(X_train, y_train)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>regr5 <span class="op">=</span> model5.fit(X_train, y_train)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>regr6 <span class="op">=</span> model6.fit(X_train, y_train)</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>regr7 <span class="op">=</span> model7.fit(X_train, y_train)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>regr8 <span class="op">=</span> model8.fit(X_train, y_train)</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>regr9 <span class="op">=</span> model9.fit(X_train, y_train)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>regr10 <span class="op">=</span> model10.fit(X_train, y_train)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>regr11 <span class="op">=</span> model11.fit(X_train, y_train)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>regr12 <span class="op">=</span> model12.fit(X_train, y_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>c:\Users\uriso\anaconda3\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:549: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
  self.n_iter_ = _check_optimize_result("lbfgs", opt_res, self.max_iter)
c:\Users\uriso\anaconda3\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1000) reached and the optimization hasn't converged yet.
  warnings.warn(
c:\Users\uriso\anaconda3\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1000) reached and the optimization hasn't converged yet.
  warnings.warn(
c:\Users\uriso\anaconda3\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1000) reached and the optimization hasn't converged yet.
  warnings.warn(
c:\Users\uriso\anaconda3\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1000) reached and the optimization hasn't converged yet.
  warnings.warn(
c:\Users\uriso\anaconda3\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1000) reached and the optimization hasn't converged yet.
  warnings.warn(
c:\Users\uriso\anaconda3\lib\site-packages\sklearn\neural_network\_multilayer_perceptron.py:692: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (1000) reached and the optimization hasn't converged yet.
  warnings.warn(</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>y_pred1 <span class="op">=</span>model1.predict(X_test)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>y_pred1 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred1).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>accuracy1 <span class="op">=</span> accuracy_score(y_test, y_pred1)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="op">=</span>model2.predict(X_test)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred2).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>accuracy2 <span class="op">=</span> accuracy_score(y_test, y_pred2)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>y_pred3 <span class="op">=</span>model3.predict(X_test)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>y_pred3 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred3).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>accuracy3 <span class="op">=</span> accuracy_score(y_test, y_pred3)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>y_pred4 <span class="op">=</span>model4.predict(X_test)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>y_pred4 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred4).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>accuracy4 <span class="op">=</span> accuracy_score(y_test, y_pred4)</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>y_pred5 <span class="op">=</span>model5.predict(X_test)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>y_pred5 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred5).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>accuracy5 <span class="op">=</span> accuracy_score(y_test, y_pred5)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>y_pred6 <span class="op">=</span>model6.predict(X_test)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>y_pred6 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred6).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>accuracy6 <span class="op">=</span> accuracy_score(y_test, y_pred6)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>y_pred7 <span class="op">=</span>model7.predict(X_test)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>y_pred7 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred7).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>accuracy7 <span class="op">=</span> accuracy_score(y_test, y_pred7)</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>y_pred8 <span class="op">=</span>model8.predict(X_test)</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>y_pred8 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred8).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>accuracy8 <span class="op">=</span> accuracy_score(y_test, y_pred8)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>y_pred9 <span class="op">=</span>model9.predict(X_test)</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>y_pred9 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred9).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>accuracy9 <span class="op">=</span> accuracy_score(y_test, y_pred9)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>y_pred10 <span class="op">=</span>model10.predict(X_test)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>y_pred10 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred10).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>accuracy10 <span class="op">=</span> accuracy_score(y_test, y_pred10)</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>y_pred11 <span class="op">=</span>model11.predict(X_test)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>y_pred11 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred11).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>accuracy11 <span class="op">=</span> accuracy_score(y_test, y_pred11)</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>y_pred12 <span class="op">=</span>model12.predict(X_test)</span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>y_pred12 <span class="op">=</span> np.clip(np.<span class="bu">round</span>(y_pred12).astype(<span class="bu">int</span>), <span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>accuracy12 <span class="op">=</span> accuracy_score(y_test, y_pred12)</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'Activation Function\solver'</span>: [<span class="st">'identity'</span>, <span class="st">'logistic'</span>, <span class="st">'tanh'</span>, <span class="st">'relu'</span>],</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">'lbfgs'</span>: [accuracy1,accuracy4, accuracy7, accuracy10],</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">'sgd'</span>: [accuracy2, accuracy5, accuracy8, accuracy11],</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>        <span class="st">'adam'</span>: [accuracy3, accuracy6, accuracy9, accuracy12]}</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>dff <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>dff.set_index(<span class="st">'Activation Function\solver'</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               lbfgs       sgd      adam
Activation Function\solver                              
identity                    0.756757  0.756757  0.756757
logistic                    0.540541  0.756757  0.702703
tanh                        0.540541  0.540541  0.405405
relu                        0.432432  0.675676  0.459459</code></pre>
</div>
</div>
<section id="method" class="level3">
<h3 class="anchored" data-anchor-id="method">Method</h3>
<p>We explore various combinations of activation functions and solvers in MLPRegressor to predict salary categories from a given dataset. First preprocess the dataset by removing missing values, encoding categorical features, and scaling the data. The target variable salary is then divided into five different bins (0-100000, 100000-200000, 200000-300000, 30000-400000, 400000-infinty). After splitting the dataset into training and testing sets, MLPRegressor models were trained using different combinations of activation functions (identity, logistic, tanh, and relu) and solvers (lbfgs, sgd, and adam). Predictions for each combination are then made on the test set and rounded to the nearest integer. The accuracy of each combination is calculated by comparing the predicted salary category with the actual salary category in the test set.</p>
</section>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>From the results it is evident that the combination of activation=‘identity’ and the solvers ‘lbfgs’, ‘sgd’ and ‘adam’ produces the highest accuracy of 0.7567567567567568. This shows that the “identity” activation function using any of the three solvers performs better at predicting salary categories based on a given dataset. On the other hand, the combination of activation=‘tanh’ and solver=‘adam’ resulted in the lowest accuracy of 0.40540540540540543, indicating that it may not be suitable for this dataset or for predicting salary categories. Overall, the code provides insight into how different activation functions and solvers affect the performance of an MLPRegressor model on a given dataset, which can help us determine the best combination for predicting salary categories.</p>
</section>
<section id="visualize-fitting-history" class="level3">
<h3 class="anchored" data-anchor-id="visualize-fitting-history">Visualize fitting history</h3>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print(regr.validation_scores_)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># training log-loss</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ax.plot(regr3.loss_curve_,<span class="st">"o"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="project_ann_mf_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>The accuracy of this model is around 75%. The model uses activation=‘identity’, the hyperbolic tan function, solver=‘adam’ stochastic gradient descent. This figure shows the loss curve of “MLPRegressor” during training. The loss curve represents the error between the model prediction and the true target value as a function of iterations. The model stabilizes after about 25 iterations.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>